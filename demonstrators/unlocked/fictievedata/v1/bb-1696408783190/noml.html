<html >
  <head></head>
  <body>
    <script>

  

    </script>
<script src="./noml/graphre.js"></script>
<script src="./noml/nomnoml.js"></script>
<link rel="stylesheet" href="./noml/font-awesome.min.css">


  <button   onclick="resetView()" style=" position: absolute;
  right:20px ; top:20px;width:30px;height:25px">
  <i  class="fa fa-home"></i>
  </button>

  <canvas id="target-canvas">
  


  </canvas>


<script>
  //<script src="//unpkg.com/graphre/dist/graphre.js">
//<script src="//unpkg.com/nomnoml/dist/nomnoml.js">
//<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
 //   var canvas = document.getElementById('target-canvas');
 //   var source = '[nomnoml] is -> [awesome]';
 //   nomnoml.draw(canvas, source);
</script>

<script src='https://unpkg.com/panzoom@9.4.0/dist/panzoom.min.js'></script>


<script type="text/javascript" src="integrator.js" ></script> 

<script>
Iface.prototype.afterIntegration=function()
{

  var element = document.querySelector('#target-canvas');
 
  document.panzoom=panzoom(element);
this.redrawOnlyOnceB=true;
//console.log("redraw once start")
   this.redrawOnlyOnce2(); //firefox bugfix
  
        
 
}

Iface.prototype.redrawOnlyOnce2=function()
{

    var me=this;
    if (this.redrawOnlyOnceB==false) 
    {
     //  console.log("weird");
      return 
    };
    var element = document.querySelector('#target-canvas');
     if (element.clientHeight==0)
     {
       //console.log("timing out ",  this.redrawOnlyOnceB);
       setTimeout(function(){me.redrawOnlyOnce2();},250);
       return;
     }
     this.redrawOnlyOnceB=false;
     console.log("redraw once",  this.redrawOnlyOnceB);
   
     redraw();
    
}



function redraw()
{
     var canvas = document.getElementById('target-canvas');
     nomnoml.draw(canvas, document.results);
}



function resetView()
{
  let tt=document.panzoom.getTransform();
 
  document.panzoom.moveTo(0,0);
  setTimeout(function(){
   // document.panzoom.moveTo(0,0);
    let t=document.panzoom.getTransform();
    document.panzoom.zoomTo(0, 0, 1/t.scale);
},10);

}

Iface.prototype.setBeginSparqlResults=function(results,sparql)
{
  var me = this;
  document.results=results;
  
    if (results!=null)
    {

        var canvas = document.getElementById('target-canvas');
        
      
         document.canvas=canvas;
         nomnoml.draw(canvas, results);
    }

}
 

 

//console.log("yasgui startIntegration");
startIntegration();
</script>
</body>