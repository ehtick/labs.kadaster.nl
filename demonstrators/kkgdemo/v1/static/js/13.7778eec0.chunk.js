(this["webpackJsonpviewer-builder-client"]=this["webpackJsonpviewer-builder-client"]||[]).push([[13],{1322:function(_,e,a){"use strict";var r=a(346),t=a.n(r),n=a(94),l=a.n(n),o=a(497),i=a.n(o),s=a(1323),c=a.n(s),u=a(205),d=a.n(u),p=a(0),E=a.n(p),f=a(16),D=a.n(f);function O(_,e,a){return void 0===e&&(e=[]),void 0===a&&(a=0),e.length>a?Promise.resolve():_.isDirectory?new Promise((function(r){_.createReader().readEntries((function(_){var t=[];_.forEach((function(_){t.push(O(_,e,a))})),Promise.all(t).then((function(){return r()}))}),(function(){return r()}))})):new Promise((function(r){_.file((function(t){e.length>=a||(_.fullPath&&!t.webkitRelativePath&&(Object.defineProperties(t,{webkitRelativePath:{writable:!0}}),t.webkitRelativePath=_.fullPath.replace(/^\//,""),Object.defineProperties(t,{webkitRelativePath:{writable:!1}})),e.push(t)),r()}),(function(){return r()}))}))}var h=function(_){function e(){for(var e,a=arguments.length,r=new Array(a),t=0;t<a;t++)r[t]=arguments[t];return e=_.call.apply(_,[this].concat(r))||this,d()(i()(e),"inputRef",E.a.createRef()),d()(i()(e),"handleChange",(function(_){for(var a=e.props,r=a.maxFiles,t=a.onChange,n=_.target.files||[],l=[],o=Math.min(r,n.length),i=0;i<o;i++)l.push(n[i]);t&&t(l)})),d()(i()(e),"handleClick",(function(_){var a,r=e.props,t=r.openFileDialogOnClick,n=r.onClick;!e.isDisabledOrReadOnly()&&t&&(null===(a=e.inputRef.current)||void 0===a||a.click());n&&n(_)})),d()(i()(e),"handleKeyDown",(function(_){var a,r=e.props,t=r.openFileDialogOnClick,n=r.onKeyDown;13===_.keyCode&&!e.isDisabledOrReadOnly()&&t&&(null===(a=e.inputRef.current)||void 0===a||a.click());n&&n(_)})),d()(i()(e),"handleDragOver",(function(_){var a=e.props.onDragOver;_.preventDefault(),a&&a(_)})),d()(i()(e),"handleDrop",(function(_){var a=e.props,r=a.directory,t=a.maxFiles,n=a.droppable,l=a.onDrop,o=a.onChange,i=[];if(_.preventDefault(),l&&l(_),!e.isDisabledOrReadOnly()&&n){var s=_.dataTransfer.files;if(r){for(var c=_.dataTransfer.items,u=[],d=0;d<c.length;d++){var p=c[d].webkitGetAsEntry();p&&u.push(O(p,i,t))}Promise.all(u).then((function(){o&&o(i)}))}else{for(var E=Math.min(t,s.length),f=0;f<E;f++)i.push(s[f]);o&&o(i)}}})),e}c()(e,_);var a=e.prototype;return a.isDisabledOrReadOnly=function(){return this.props.disabled||this.props.readOnly},a.render=function(){var _,e=this.props,a=e.prefixCls,r=e.className,n=e.name,o=e.accept,i=e.multiple,s=e.inputKey,c=e.tabIndex,u=e.children,d=e.tagName,p=(e.onChange,e.disabled),f=e.readOnly,O=e.directory,h=(e.openFileDialogOnClick,e.maxFiles,e.droppable,l()(e,["prefixCls","className","name","accept","multiple","inputKey","tabIndex","children","tagName","onChange","disabled","readOnly","directory","openFileDialogOnClick","maxFiles","droppable"])),m=D()(a,((_={})[a+"-disabled"]=p,_[a+"-readonly"]=f,_),r),b=d,P={directory:O?"directory":null,webkitdirectory:O?"webkitdirectory":null};return E.a.createElement(b,t()({},h,{tabIndex:c,className:m,onClick:this.handleClick,onKeyDown:this.handleKeyDown,onDragOver:this.handleDragOver,onDrop:this.handleDrop}),E.a.createElement("input",t()({},P,{key:s,ref:this.inputRef,name:n,accept:o,multiple:i,type:"file",style:{display:"none"},onClick:function(_){return _.stopPropagation()},onChange:this.handleChange})),u)},e}(E.a.Component);d()(h,"defaultProps",{prefixCls:"rw-upload",tagName:"div",tabIndex:0,maxFiles:Number.MAX_VALUE,droppable:!0,openFileDialogOnClick:!0}),e.a=h},1323:function(_,e,a){var r=a(492);_.exports=function(_,e){_.prototype=Object.create(e.prototype),_.prototype.constructor=_,r(_,e)},_.exports.__esModule=!0,_.exports.default=_.exports},1324:function(_,e,a){_.exports={uploadtest:"BBUpload_uploadtest__2XYYP",upload1:"BBUpload_upload1__2qlqt",text:"BBUpload_text__198fb",tips:"BBUpload_tips__1CuvP",upload2:"BBUpload_upload2__1L0yD"}},1325:function(_,e,a){"use strict";a(1326)},1326:function(_,e,a){},1505:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var D_bim_connected_configurator_linked_data_view_configurator_front_end_node_modules_babel_runtime_helpers_esm_classCallCheck_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(4),D_bim_connected_configurator_linked_data_view_configurator_front_end_node_modules_babel_runtime_helpers_esm_createClass_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(5),D_bim_connected_configurator_linked_data_view_configurator_front_end_node_modules_babel_runtime_helpers_esm_assertThisInitialized_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(28),D_bim_connected_configurator_linked_data_view_configurator_front_end_node_modules_babel_runtime_helpers_esm_inherits_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(11),D_bim_connected_configurator_linked_data_view_configurator_front_end_node_modules_babel_runtime_helpers_esm_createSuper_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(12),_bbutil__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(67),_bbutil__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(_bbutil__WEBPACK_IMPORTED_MODULE_5__),react__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_6__),_Spinner__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(83),react_widget_upload__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(1322),_BBUpload_module_css__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(1324),_BBUpload_module_css__WEBPACK_IMPORTED_MODULE_9___default=__webpack_require__.n(_BBUpload_module_css__WEBPACK_IMPORTED_MODULE_9__),_helpers_PublishUtils__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(24),react_widget_upload_style__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(1325),_helpers_sparql__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(45),_helpers_url__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(55),axios__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(42),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(1),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_15___default=__webpack_require__.n(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_15__),BBUpload=function(_Component){Object(D_bim_connected_configurator_linked_data_view_configurator_front_end_node_modules_babel_runtime_helpers_esm_inherits_js__WEBPACK_IMPORTED_MODULE_3__.a)(BBUpload,_Component);var _super=Object(D_bim_connected_configurator_linked_data_view_configurator_front_end_node_modules_babel_runtime_helpers_esm_createSuper_js__WEBPACK_IMPORTED_MODULE_4__.a)(BBUpload);function BBUpload(){var _this;Object(D_bim_connected_configurator_linked_data_view_configurator_front_end_node_modules_babel_runtime_helpers_esm_classCallCheck_js__WEBPACK_IMPORTED_MODULE_0__.a)(this,BBUpload);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return _this=_super.call.apply(_super,[this].concat(args)),_this.state={files:[],enabled:!0},_this.handleChange=function(files){_this.setState({files:files,enabled:!1});var formData=new FormData,extra=_this.props.extraJSON;if(null!=extra)try{for(var key in extra=JSON.parse(extra),extra){var l=Object(_helpers_sparql__WEBPACK_IMPORTED_MODULE_12__.c)(extra[key],_this.props);formData.append(key,l)}}catch(e){console.log(e)}var me=Object(D_bim_connected_configurator_linked_data_view_configurator_front_end_node_modules_babel_runtime_helpers_esm_assertThisInitialized_js__WEBPACK_IMPORTED_MODULE_2__.a)(_this);if(files.length){var file=files[0];formData.append("command",_this.props.command),formData.append("file",file,file.name),axios__WEBPACK_IMPORTED_MODULE_14__.a.defaults.withCredentials=!0,axios__WEBPACK_IMPORTED_MODULE_14__.a.defaults.credentials="include";var url=_this.props.serverUrl;null!=url?(url.startsWith("http")||(url=Object(_helpers_url__WEBPACK_IMPORTED_MODULE_13__.b)(_this.props.repoURL).replace("sparql",url)),axios__WEBPACK_IMPORTED_MODULE_14__.a.post(url,formData).then((function(arg){if(console.log("SUCCESS upload ",arg,me.props.resultUri),null!=me.props.resultUri)try{var uri=arg.data.uri;if(null!=uri){var par=me.props.resultUri;me.props.publish(par,uri)}}catch(e){}if(null!=me.props.successEval){console.log("executing after upload ",me.props.successEval);try{eval(me.props.successEval)}catch(e){console.log(e)}}_helpers_PublishUtils__WEBPACK_IMPORTED_MODULE_10__.a.setTimeStampParameter(me,!0),me.setState({enabled:!0})})).catch((function(_){console.log("upload failure ",_),alert("could not upload file"),me.setState({enabled:!0})}))):alert("no upload url defined")}},_this}return Object(D_bim_connected_configurator_linked_data_view_configurator_front_end_node_modules_babel_runtime_helpers_esm_createClass_js__WEBPACK_IMPORTED_MODULE_1__.a)(BBUpload,[{key:"downloadReport",value:function(_,e){var a=this.props.serverUrl;if(null!=a){a.startsWith("http")||(a=this.props.repoURL),a=a.replace("sparql","download"),console.log("download ",a,_);var r={};null==_&&(_=""),r.fileToDownload=_;var t=this;axios__WEBPACK_IMPORTED_MODULE_14__.a.defaults.withCredentials=!0,axios__WEBPACK_IMPORTED_MODULE_14__.a.defaults.credentials="include",axios__WEBPACK_IMPORTED_MODULE_14__.a.post(a,null,{params:r}).then((function(_){console.log("success data download ",_);var a=window.URL.createObjectURL(new Blob([_.data])),r=document.createElement("a");r.href=a,null==e&&(e="file.txt"),r.setAttribute("download",e),document.body.appendChild(r),r.click(),r.remove(),setTimeout((function(){t.setState({enabled:!0})}),5e3)})).catch((function(_){alert("error downloading"),console.log("FAILURE!!",_)}))}else alert("no download url defined")}},{key:"render",value:function(){var _=this.state.enabled,e=this.props.uploadText;return null==e&&(e="upload"),!1===_&&null==(e=this.props.processingText)&&(e="processing"),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_15__.jsxs)("div",{className:_BBUpload_module_css__WEBPACK_IMPORTED_MODULE_9___default.a.uploadtest,children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_15__.jsx)(_Spinner__WEBPACK_IMPORTED_MODULE_7__.a,{loading:!_,children:" "}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_15__.jsx)(react_widget_upload__WEBPACK_IMPORTED_MODULE_8__.a,{onChange:this.handleChange,className:_BBUpload_module_css__WEBPACK_IMPORTED_MODULE_9___default.a.upload1,openFileDialogOnClick:_,droppable:_,children:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_15__.jsxs)("div",{className:_BBUpload_module_css__WEBPACK_IMPORTED_MODULE_9___default.a.text,children:[e," "]})})]})}}]),BBUpload}(react__WEBPACK_IMPORTED_MODULE_6__.Component);__webpack_exports__.default=BBUpload}}]);
//# sourceMappingURL=13.7778eec0.chunk.js.map