{"version":3,"sources":["../node_modules/react-widget-upload/esm/index.js","../node_modules/@babel/runtime/helpers/inheritsLoose.js","components/widgets/bb/BBUpload.module.css","../node_modules/react-widget-upload/esm/style/index.js","components/widgets/bb/BBUpload.js"],"names":["scanFiles","item","files","maxFiles","length","Promise","resolve","isDirectory","createReader","readEntries","entries","p","forEach","entry","push","all","then","file","fullPath","webkitRelativePath","Object","defineProperties","writable","replace","Upload","_React$Component","_this","_len","arguments","args","Array","_key","call","apply","this","concat","_defineProperty","_assertThisInitialized","React","createRef","e","_this$props","props","onChange","items","target","fileLen","Math","min","i","_this$inputRef$curren","_this$props2","openFileDialogOnClick","onClick","isDisabledOrReadOnly","inputRef","current","click","_this$inputRef$curren2","_this$props3","onKeyDown","keyCode","onDragOver","preventDefault","_this$props4","directory","droppable","onDrop","dataTransfer","_items","webkitGetAsEntry","_i","_inheritsLoose","_proto","prototype","disabled","readOnly","render","_classnames","_this$props5","prefixCls","className","name","accept","multiple","inputKey","tabIndex","children","tagName","restProps","_objectWithoutProperties","cls","classnames","Tag","inputProps","webkitdirectory","createElement","_extends","handleClick","handleKeyDown","handleDragOver","handleDrop","key","ref","type","style","display","stopPropagation","handleChange","Component","Number","MAX_VALUE","setPrototypeOf","module","exports","subClass","superClass","create","constructor","__esModule","BBUpload","state","enabled","setState","formData","FormData","extra","extraJSON","JSON","parse","l","parseTextForVariables","append","console","log","me","command","axios","defaults","withCredentials","credentials","url","serverUrl","startsWith","getAbsoluteRepoUrl","repoURL","post","arg","resultUri","uri","data","par","publish","successEval","eval","PublishUtils","setTimeStampParameter","catch","alert","o","fileToDownload","params","downloadUrl","window","URL","createObjectURL","Blob","link","document","href","setAttribute","body","appendChild","remove","setTimeout","text","uploadText","processingText","styles","uploadtest","loading","upload1"],"mappings":"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","file":"static/js/10.646ac636.chunk.js","sourcesContent":["import _extends from \"@babel/runtime/helpers/extends\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/objectWithoutProperties\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/assertThisInitialized\";\nimport _inheritsLoose from \"@babel/runtime/helpers/inheritsLoose\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport React from \"react\";\nimport classnames from \"classnames\";\n\nfunction scanFiles(item, files, maxFiles) {\n  if (files === void 0) {\n    files = [];\n  }\n\n  if (maxFiles === void 0) {\n    maxFiles = 0;\n  }\n\n  if (files.length > maxFiles) {\n    return Promise.resolve();\n  }\n\n  if (item.isDirectory) {\n    return new Promise(function (resolve) {\n      var directoryReader = item.createReader();\n      directoryReader.readEntries(function (entries) {\n        var p = [];\n        entries.forEach(function (entry) {\n          p.push(scanFiles(entry, files, maxFiles));\n        });\n        Promise.all(p).then(function () {\n          return resolve();\n        });\n      }, function () {\n        return resolve();\n      });\n    });\n  } else {\n    return new Promise(function (resolve) {\n      item.file(function (file) {\n        if (files.length >= maxFiles) {\n          resolve();\n          return;\n        }\n\n        if (item.fullPath && !file.webkitRelativePath) {\n          Object.defineProperties(file, {\n            webkitRelativePath: {\n              writable: true\n            }\n          });\n          file.webkitRelativePath = item.fullPath.replace(/^\\//, \"\");\n          Object.defineProperties(file, {\n            webkitRelativePath: {\n              writable: false\n            }\n          });\n        }\n\n        files.push(file);\n        resolve();\n      }, function () {\n        return resolve();\n      });\n    });\n  }\n}\n\nexport var version = \"1.0.1\";\nexport var Upload = /*#__PURE__*/function (_React$Component) {\n  _inheritsLoose(Upload, _React$Component);\n\n  function Upload() {\n    var _this;\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _React$Component.call.apply(_React$Component, [this].concat(args)) || this;\n\n    _defineProperty(_assertThisInitialized(_this), \"inputRef\", /*#__PURE__*/React.createRef());\n\n    _defineProperty(_assertThisInitialized(_this), \"handleChange\", function (e) {\n      var _this$props = _this.props,\n          maxFiles = _this$props.maxFiles,\n          onChange = _this$props.onChange;\n      var items = e.target.files || [];\n      var files = [];\n      var fileLen = Math.min(maxFiles, items.length);\n\n      for (var i = 0; i < fileLen; i++) {\n        files.push(items[i]);\n      }\n\n      if (onChange) {\n        onChange(files);\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleClick\", function (e) {\n      var _this$props2 = _this.props,\n          openFileDialogOnClick = _this$props2.openFileDialogOnClick,\n          onClick = _this$props2.onClick;\n\n      if (!_this.isDisabledOrReadOnly() && openFileDialogOnClick) {\n        var _this$inputRef$curren;\n\n        (_this$inputRef$curren = _this.inputRef.current) === null || _this$inputRef$curren === void 0 ? void 0 : _this$inputRef$curren.click();\n      }\n\n      if (onClick) {\n        onClick(e);\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleKeyDown\", function (e) {\n      var _this$props3 = _this.props,\n          openFileDialogOnClick = _this$props3.openFileDialogOnClick,\n          onKeyDown = _this$props3.onKeyDown;\n\n      if (e.keyCode === 13 && !_this.isDisabledOrReadOnly() && openFileDialogOnClick) {\n        var _this$inputRef$curren2;\n\n        (_this$inputRef$curren2 = _this.inputRef.current) === null || _this$inputRef$curren2 === void 0 ? void 0 : _this$inputRef$curren2.click();\n      }\n\n      if (onKeyDown) {\n        onKeyDown(e);\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleDragOver\", function (e) {\n      var onDragOver = _this.props.onDragOver;\n      e.preventDefault();\n\n      if (onDragOver) {\n        onDragOver(e);\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleDrop\", function (e) {\n      var _this$props4 = _this.props,\n          directory = _this$props4.directory,\n          maxFiles = _this$props4.maxFiles,\n          droppable = _this$props4.droppable,\n          onDrop = _this$props4.onDrop,\n          onChange = _this$props4.onChange;\n      var files = [];\n      e.preventDefault();\n\n      if (onDrop) {\n        onDrop(e);\n      }\n\n      if (_this.isDisabledOrReadOnly() || !droppable) return;\n      var items = e.dataTransfer.files;\n\n      if (directory) {\n        var _items = e.dataTransfer.items;\n        var p = [];\n\n        for (var i = 0; i < _items.length; i++) {\n          var item = _items[i].webkitGetAsEntry();\n\n          if (item) {\n            p.push(scanFiles(item, files, maxFiles));\n          }\n        }\n\n        Promise.all(p).then(function () {\n          if (onChange) {\n            onChange(files);\n          }\n        });\n      } else {\n        var fileLen = Math.min(maxFiles, items.length);\n\n        for (var _i = 0; _i < fileLen; _i++) {\n          files.push(items[_i]);\n        }\n\n        if (onChange) {\n          onChange(files);\n        }\n      }\n    });\n\n    return _this;\n  }\n\n  var _proto = Upload.prototype;\n\n  _proto.isDisabledOrReadOnly = function isDisabledOrReadOnly() {\n    return this.props.disabled || this.props.readOnly;\n  };\n\n  _proto.render = function render() {\n    var _classnames;\n\n    var _this$props5 = this.props,\n        prefixCls = _this$props5.prefixCls,\n        className = _this$props5.className,\n        name = _this$props5.name,\n        accept = _this$props5.accept,\n        multiple = _this$props5.multiple,\n        inputKey = _this$props5.inputKey,\n        tabIndex = _this$props5.tabIndex,\n        children = _this$props5.children,\n        tagName = _this$props5.tagName,\n        onChange = _this$props5.onChange,\n        disabled = _this$props5.disabled,\n        readOnly = _this$props5.readOnly,\n        directory = _this$props5.directory,\n        openFileDialogOnClick = _this$props5.openFileDialogOnClick,\n        maxFiles = _this$props5.maxFiles,\n        droppable = _this$props5.droppable,\n        restProps = _objectWithoutProperties(_this$props5, [\"prefixCls\", \"className\", \"name\", \"accept\", \"multiple\", \"inputKey\", \"tabIndex\", \"children\", \"tagName\", \"onChange\", \"disabled\", \"readOnly\", \"directory\", \"openFileDialogOnClick\", \"maxFiles\", \"droppable\"]);\n\n    var cls = classnames(prefixCls, (_classnames = {}, _classnames[prefixCls + \"-disabled\"] = disabled, _classnames[prefixCls + \"-readonly\"] = readOnly, _classnames), className);\n    var Tag = tagName;\n    var inputProps = {\n      directory: directory ? \"directory\" : null,\n      webkitdirectory: directory ? \"webkitdirectory\" : null\n    };\n    return /*#__PURE__*/React.createElement(Tag, _extends({}, restProps, {\n      tabIndex: tabIndex,\n      className: cls,\n      onClick: this.handleClick,\n      onKeyDown: this.handleKeyDown,\n      onDragOver: this.handleDragOver,\n      onDrop: this.handleDrop\n    }), /*#__PURE__*/React.createElement(\"input\", _extends({}, inputProps, {\n      key: inputKey,\n      ref: this.inputRef,\n      name: name,\n      accept: accept,\n      multiple: multiple,\n      type: \"file\",\n      style: {\n        display: \"none\"\n      },\n      onClick: function onClick(e) {\n        return e.stopPropagation();\n      },\n      onChange: this.handleChange\n    })), children);\n  };\n\n  return Upload;\n}(React.Component);\n\n_defineProperty(Upload, \"defaultProps\", {\n  prefixCls: \"rw-upload\",\n  tagName: \"div\",\n  tabIndex: 0,\n  maxFiles: Number.MAX_VALUE,\n  droppable: true,\n  openFileDialogOnClick: true\n});\n\nexport default Upload;","var setPrototypeOf = require(\"./setPrototypeOf.js\");\nfunction _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  setPrototypeOf(subClass, superClass);\n}\nmodule.exports = _inheritsLoose, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","// extracted by mini-css-extract-plugin\nmodule.exports = {\"uploadtest\":\"BBUpload_uploadtest__2XYYP\",\"upload1\":\"BBUpload_upload1__2qlqt\",\"text\":\"BBUpload_text__198fb\",\"tips\":\"BBUpload_tips__1CuvP\",\"upload2\":\"BBUpload_upload2__1L0yD\"};","import \"./index.css\";","import './bbutil'\n\nimport React, { Component } from 'react'\nimport Spinner from '../../Spinner'\n\nimport Upload from 'react-widget-upload'\nimport styles from './BBUpload.module.css'\nimport PublishUtils from '../../../helpers/PublishUtils'\nimport 'react-widget-upload/style'\nimport {parseTextForVariables}   from '../../../helpers/sparql'\nimport { getAbsoluteRepoUrl, getCgiUrl } from '../../../helpers/url'\n\nimport axios from 'axios'\n\n/*\n//class BBUpload extends BBIFrame {\n  constructor222()\n  {\n     super();\n  \n     this.scrolling=\"true\";\n     this.noEvents=false;\n \n  }\n\n*/\n\nclass BBUpload extends Component {\n  state = {\n    files: [],\n    enabled: true,\n  }\n\n  downloadReport(key, file) {\n    let url = this.props.serverUrl\n    if (url == null) {\n      alert('no download url defined')\n      return\n    }\n\n    if (!url.startsWith('http')) {\n      url = this.props.repoURL\n    }\n    url = url.replace('sparql', 'download')\n    console.log('download ', url, key)\n    //const formData = new FormData();\n    //formData.append(\"fileToDownload\",key);\n    //formData.append(\"test\",\"hans\");\n    let o = {}\n\n    if (key == null) {\n      key = ''\n    }\n    o.fileToDownload = key\n    var me = this\n\n    axios.defaults.withCredentials = true\n    axios.defaults.credentials = 'include'\n    axios\n      .post(url, null, { params: o })\n      .then(function (data) {\n        console.log('success data download ', data)\n        const downloadUrl = window.URL.createObjectURL(new Blob([data.data]))\n\n        const link = document.createElement('a')\n\n        link.href = downloadUrl\n        if (file == null) {\n          file = 'file.txt'\n        }\n        link.setAttribute('download', file) //any other extension\n\n        document.body.appendChild(link)\n\n        link.click()\n\n        link.remove()\n\n        setTimeout(function () {\n          me.setState({ enabled: true })\n        }, 5000)\n      })\n      .catch(function (e) {\n        alert('error downloading')\n        console.log('FAILURE!!', e)\n      })\n  }\n\n  handleChange = (files) => {\n    this.setState({\n      files,\n      enabled: false,\n    })\n    const formData = new FormData()\n\n    var extra=this.props.extraJSON;\n    if (extra!=null)\n    {\n      try\n      {\n             extra=JSON.parse(extra);\n             for (var key in extra)\n             {\n            \n              var l=parseTextForVariables(extra[key],this.props);\n              \n             // console.log(key,extra[key],l);\n              formData.append(key,l);\n             }\n      }\n      catch(e){console.log(e);}\n    }\n\n\n\n\n    \n\n    var me = this\n    if (!files.length) return\n    const file = files[0]\n\n\n    formData.append('command', this.props.command)\n    formData.append('file', file, file.name)\n    \n    axios.defaults.withCredentials = true\n    axios.defaults.credentials = 'include'\n    let url = this.props.serverUrl\n    if (url == null) {\n      alert('no upload url defined')\n      return\n    }\n\n   \n    if (!url.startsWith('http')) {\n      url = getAbsoluteRepoUrl(this.props.repoURL).replace('sparql', url)\n    }\n    //console.log(this.props,url);\n    axios\n      .post(url, formData)\n      .then(function (arg) {\n        console.log('SUCCESS upload ',arg,me.props.resultUri);\n        if (me.props.resultUri != null) {\n          try\n          {\n                  var uri= arg.data.uri;\n                  if (uri!=null)\n                  {\n                    var par = me.props.resultUri;\n                    me.props.publish(par, uri);\n                  }\n          }\n          catch(e){}\n        }\n        if (me.props.successEval != null) {\n          console.log('executing after upload ', me.props.successEval)\n          try {\n            eval(me.props.successEval) //eslint-disable-line no-eval\n          } catch (e) {\n            console.log(e)\n          }\n         \n        }\n        PublishUtils.setTimeStampParameter(me, true)\n        me.setState({ enabled: true })\n      })\n      .catch(function (e) {\n        console.log('upload failure ',e);\n        alert('could not upload file')\n        me.setState({ enabled: true })\n      })\n  }\n\n  render() {\n    const enabled = this.state.enabled\n    var text = this.props.uploadText\n\n    if (text == null) {\n      text = 'upload'\n    }\n    if (enabled === false) {\n      text = this.props.processingText\n      if (text == null) {\n        text = 'processing'\n      }\n      // return  (<Spinner loading=\"true\" ></Spinner>)\n    }\n\n    return (\n      <div className={styles.uploadtest}>\n        <Spinner loading={!enabled}> </Spinner>\n        <Upload\n          onChange={this.handleChange}\n          className={styles.upload1}\n          openFileDialogOnClick={enabled}\n          droppable={enabled}\n        >\n          <div className={styles.text}>{text} </div>\n        </Upload>\n      </div>\n    )\n  }\n \n\n \n}\n\nexport default BBUpload\n"],"sourceRoot":""}