(this["webpackJsonpviewer-builder-client"]=this["webpackJsonpviewer-builder-client"]||[]).push([[49],{1559:function(e,t,o){"use strict";o.r(t);var n=o(9),r=o(17),a=o(4),c=o(5),s=o(29),l=o(11),i=o(12),u=(o(70),o(35)),p=o(1439),d=o(25),f=o(1440),h=function(e){Object(l.a)(o,e);var t=Object(i.a)(o);function o(){var e;return Object(a.a)(this,o),(e=t.call(this)).getUrl=function(){return"/".concat(window.bbFolderName,"/w2ui/table.html")},e.resolveParameterValue=function(t){return d.a.processStringForParameters(Object(s.a)(e),t)},e.exportToSpreadsheet=function(){var t=Object(r.a)(Object(n.a)().mark((function t(o,r){var a,c,s;return Object(n.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=!1;try{a=e.props.downloadNoHeader}catch(n){}c=null;try{c=e.props.downloadURL}catch(n){}if(null==c||""==c)try{s=new f.Workbook,e.exportToSpreadSheetInternal(o,s,a)}catch(r){console.log(r),e.showToast("could not create excelfile")}else try{e.exportToExistingSpreadSheet(o,c,a)}catch(r){console.log(r),e.showToast("could not create excelfile")}case 5:case"end":return t.stop()}}),t)})));return function(e,o){return t.apply(this,arguments)}}(),e.exportToExistingSpreadSheet=function(){var t=Object(r.a)(Object(n.a)().mark((function t(o,r,a){var c;return Object(n.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:c=Object(s.a)(e);try{fetch(r).then((function(e){return e.arrayBuffer()})).then((function(t){var n=new f.Workbook;try{n.xlsx.load(t,{ignoreNodes:["dataValidations"]}).then((function(e){c.exportToSpreadSheetInternal(o,n,a);try{c.iface.endDownloadEvent()}catch(t){console.log(t)}})).catch((function(t){console.error("Error fetching data:",t),e.showToast("could not create excelfile. Template excel file is not available ");try{c.iface.endDownloadEvent()}catch(o){console.log(o)}}))}catch(r){console.log(r),e.showToast("could not create excelfile");try{c.iface.endDownloadEvent()}catch(r){console.log(r)}}}))}catch(n){console.log(n),e.showToast("could not use template ");try{c.iface.endDownloadEvent()}catch(n){console.log(n)}}case 2:case"end":return t.stop()}}),t)})));return function(e,o,n){return t.apply(this,arguments)}}(),e.exportToSpreadSheetInternal=function(){var t=Object(r.a)(Object(n.a)().mark((function t(o,r,a){var c,l,i,u,f,h,w,b,x,v;return Object(n.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:c=null,r.eachSheet((function(e,t){null==c&&(c=t)})),null==(l=r.getWorksheet(c))&&(l=r.addWorksheet("export",{properties:{tabColor:{argb:"FF00FF00"}}})),i=1;try{i=parseInt(e.props.downloadStartRow)}catch(g){}null==i&&(i=1),isNaN(i)&&(i=1),t.t0=Object(n.a)().keys(o);case 9:if((t.t1=t.t0()).done){t.next=21;break}if(u=t.t1.value,f=o[u],!a||0!=u){t.next=14;break}return t.abrupt("continue",9);case 14:if(0==u){for(w in l.getRow(i).font={bold:!0},h=[],f)h.push({width:15});l.columns=h}b=JSON.parse(JSON.stringify(f)),x=l.getRow(i),i++,x.values=b,t.next=9;break;case 21:0===l.rowCount&&(console.log("add empty row"),l.addRow(["No data found"])),"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8",".xlsx",null==(v=e.props.filename)&&(v="download"),v=d.a.processStringForParameters(Object(s.a)(e),v),r.xlsx.writeBuffer().then((function(e){var t=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});p.saveAs(t,v+".xlsx")}));case 28:case"end":return t.stop()}}),t)})));return function(e,o,n){return t.apply(this,arguments)}}(),e.scrolling="true",e.noEvents=!1,e.usesParameters=!1,e}return Object(c.a)(o,[{key:"getParameters",value:function(){return this.props.wraptext?"?wraptext=true":""}},{key:"setExcelColsWidth",value:function(e,t){}}]),o}(u.a);t.default=h}}]);
//# sourceMappingURL=49.1fa97669.chunk.js.map